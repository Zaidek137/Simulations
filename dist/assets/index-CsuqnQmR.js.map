{"version":3,"file":"index-CsuqnQmR.js","sources":["../../node_modules/react-dom/client.js","../../src/components/UniverseMap/UniverseMap.tsx","../../src/components/AdminPortal/AdminPortal.tsx","../../src/components/LocalPointOverlay/LocalPointOverlay.tsx","../../src/data/universe-data.ts","../../src/lib/supabase.ts","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import React, { useEffect, useRef, useCallback } from 'react';\r\nimport * as d3 from 'd3';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { Region, Location } from '@/data/universe-data';\r\nimport styles from './UniverseMap.module.css';\r\n\r\ninterface UniverseMapProps {\r\n    onRegionSelect: (region: Region | null) => void;\r\n    selectedRegion: Region | null;\r\n    universeData: Region[];\r\n    onCoordPick?: (coords: { x: number; y: number } | null) => void;\r\n    baseBackground?: string;\r\n    onLocationSelect?: (loc: Location, screenPos: { x: number; y: number }) => void;\r\n    onLocationClose?: () => void;\r\n    zoomResetRef?: React.MutableRefObject<(() => void) | null>;\r\n}\r\n\r\nexport default function UniverseMap({ onRegionSelect, selectedRegion, universeData, onCoordPick, baseBackground = '/images/multiversal-bg.png', onLocationSelect, onLocationClose, zoomResetRef }: UniverseMapProps) {\r\n    const svgRef = useRef<SVGSVGElement>(null);\r\n    const gRef = useRef<SVGGElement>(null);\r\n    const zoomBehavior = useRef<d3.ZoomBehavior<SVGSVGElement, unknown> | null>(null);\r\n\r\n    // Initialize Zoom behavior\r\n    useEffect(() => {\r\n        if (!svgRef.current || !gRef.current) return;\r\n\r\n        const svg = d3.select(svgRef.current);\r\n        const g = d3.select(gRef.current);\r\n\r\n        const zoom = d3.zoom<SVGSVGElement, unknown>()\r\n            .scaleExtent([0.5, 4])\r\n            .on('zoom', (event) => {\r\n                g.attr('transform', event.transform);\r\n            });\r\n\r\n        zoomBehavior.current = zoom;\r\n        svg.call(zoom);\r\n\r\n        resetZoomState();\r\n    }, []);\r\n\r\n    const resetZoomState = () => {\r\n        if (!svgRef.current || !zoomBehavior.current) return;\r\n        const svg = d3.select(svgRef.current);\r\n        const initialTransform = d3.zoomIdentity\r\n            .translate(window.innerWidth / 2, window.innerHeight / 2)\r\n            .scale(0.8)\r\n            .translate(-500, -400);\r\n\r\n        svg.transition()\r\n            .duration(1200)\r\n            .ease(d3.easeCubicInOut)\r\n            .call(zoomBehavior.current.transform, initialTransform);\r\n    };\r\n\r\n    const zoomToUniverse = useCallback((region: Region) => {\r\n        if (!svgRef.current || !zoomBehavior.current) return;\r\n\r\n        const svg = d3.select(svgRef.current);\r\n        // Lower scale = wider view, shows more of the universe\r\n        const scale = 1.2;\r\n        const transform = d3.zoomIdentity\r\n            .translate(window.innerWidth / 2, window.innerHeight / 2)\r\n            .scale(scale)\r\n            .translate(-region.cx, -region.cy);\r\n\r\n        svg.transition()\r\n            .duration(1200)\r\n            .ease(d3.easeCubicInOut)\r\n            .call(zoomBehavior.current.transform, transform);\r\n    }, []);\r\n\r\n    // Expose zoom reset function for external use (e.g., closing location overlay)\r\n    useEffect(() => {\r\n        if (zoomResetRef && selectedRegion) {\r\n            zoomResetRef.current = () => zoomToUniverse(selectedRegion);\r\n        }\r\n        return () => {\r\n            if (zoomResetRef) {\r\n                zoomResetRef.current = null;\r\n            }\r\n        };\r\n    }, [zoomResetRef, selectedRegion, zoomToUniverse]);\r\n\r\n    const handleRegionClick = (region: Region, event: React.MouseEvent) => {\r\n        event.stopPropagation();\r\n        onRegionSelect(region);\r\n        zoomToUniverse(region);\r\n    };\r\n\r\n    const handleMapClick = (event: React.MouseEvent) => {\r\n        if (!gRef.current) return;\r\n\r\n        // If clicking background while in a region, check if we are picking coords\r\n        if (onCoordPick) {\r\n            const [x, y] = d3.pointer(event, gRef.current);\r\n            onCoordPick({ x, y });\r\n        }\r\n\r\n        if (!selectedRegion) {\r\n            onRegionSelect(null);\r\n        }\r\n    };\r\n\r\n    const handleLocationClick = (loc: Location, event: React.MouseEvent) => {\r\n        event.stopPropagation();\r\n\r\n        if (!onLocationSelect || !svgRef.current || !zoomBehavior.current) return;\r\n\r\n        // Get the screen position of the click for the expanding overlay origin\r\n        const screenX = event.clientX;\r\n        const screenY = event.clientY;\r\n\r\n        // Zoom to the location\r\n        const svg = d3.select(svgRef.current);\r\n        const scale = 3.5;\r\n        const transform = d3.zoomIdentity\r\n            .translate(window.innerWidth / 2, window.innerHeight / 2)\r\n            .scale(scale)\r\n            .translate(-loc.cx, -loc.cy);\r\n\r\n        svg.transition()\r\n            .duration(800)\r\n            .ease(d3.easeCubicInOut)\r\n            .call(zoomBehavior.current.transform, transform);\r\n\r\n        // Trigger the overlay after a slight delay for the zoom\r\n        setTimeout(() => {\r\n            onLocationSelect(loc, { x: screenX, y: screenY });\r\n        }, 200);\r\n    };\r\n\r\n    const handleBack = (e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        onLocationClose?.();\r\n        onRegionSelect(null);\r\n        resetZoomState();\r\n    };\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            {/* Back Button */}\r\n            <AnimatePresence>\r\n                {selectedRegion && (\r\n                    <motion.button\r\n                        className={styles.backButton}\r\n                        onClick={handleBack}\r\n                        initial={{ opacity: 0, x: -20 }}\r\n                        animate={{ opacity: 1, x: 0 }}\r\n                        exit={{ opacity: 0, x: -20 }}\r\n                    >\r\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                            <path d=\"M19 12H5M12 19l-7-7 7-7\" />\r\n                        </svg>\r\n                        Back to Multiverse\r\n                    </motion.button>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* Background Transition Layer */}\r\n            <AnimatePresence mode=\"wait\">\r\n                {(() => {\r\n                    const bgUrl = selectedRegion ? selectedRegion.backgroundUrl : baseBackground;\r\n                    const isVideo = bgUrl && (bgUrl.endsWith('.mp4') || bgUrl.endsWith('.webm') || bgUrl.endsWith('.mov'));\r\n\r\n                    return isVideo ? (\r\n                        <motion.video\r\n                            key={selectedRegion ? selectedRegion.id : 'base'}\r\n                            className={styles.backgroundVideo}\r\n                            src={bgUrl}\r\n                            autoPlay\r\n                            loop\r\n                            muted\r\n                            playsInline\r\n                            initial={{ opacity: 0, scale: 1.15 }}\r\n                            animate={{ opacity: 1, scale: 1 }}\r\n                            exit={{ opacity: 0, scale: 0.95 }}\r\n                            transition={{ duration: 1.2, ease: \"easeInOut\" }}\r\n                        />\r\n                    ) : (\r\n                        <motion.div\r\n                            key={selectedRegion ? selectedRegion.id : 'base'}\r\n                            className={styles.backgroundLayer}\r\n                            initial={{ opacity: 0, scale: 1.15 }}\r\n                            animate={{ opacity: 1, scale: 1 }}\r\n                            exit={{ opacity: 0, scale: 0.95 }}\r\n                            transition={{ duration: 1.2, ease: \"easeInOut\" }}\r\n                            style={{\r\n                                backgroundImage: `url(${bgUrl})`\r\n                            }}\r\n                        />\r\n                    );\r\n                })()}\r\n            </AnimatePresence>\r\n\r\n            <div className={styles.backgroundDimmer} />\r\n\r\n            <svg\r\n                ref={svgRef}\r\n                className={`${styles.svg} ${onCoordPick ? styles.pickingMode : ''}`}\r\n                onClick={handleMapClick}\r\n            >\r\n                <defs>\r\n                    {onCoordPick && (\r\n                        <pattern id=\"grid\" width=\"100\" height=\"100\" patternUnits=\"userSpaceOnUse\">\r\n                            <path d=\"M 100 0 L 0 0 0 100\" fill=\"none\" stroke=\"rgba(255,255,255,0.05)\" strokeWidth=\"1\" />\r\n                        </pattern>\r\n                    )}\r\n                    {universeData.map(region => (\r\n                        <radialGradient key={`grad-${region.id}`} id={`grad-${region.id}`} cx=\"50%\" cy=\"50%\" r=\"50%\">\r\n                            <stop offset=\"0%\" stopColor={region.color} stopOpacity=\"0.5\" />\r\n                            <stop offset=\"100%\" stopColor={region.color} stopOpacity=\"0\" />\r\n                        </radialGradient>\r\n                    ))}\r\n                </defs>\r\n                <g ref={gRef}>\r\n                    {onCoordPick && (\r\n                        <rect width=\"2000\" height=\"2000\" x=\"-500\" y=\"-500\" fill=\"url(#grid)\" pointerEvents=\"none\" />\r\n                    )}\r\n                    {!selectedRegion && universeData.map((region) => (\r\n                        <g key={region.id} className={styles.universeIcon}>\r\n                            {/* Spiral Galaxy Effect - Nested for stable rotation */}\r\n                            <g transform={`translate(${region.cx}, ${region.cy})`}>\r\n                                <g className={styles.spiralArms} style={{ color: region.color }}>\r\n                                    <circle r=\"150\" fill={`url(#grad-${region.id})`} pointerEvents=\"none\" />\r\n\r\n                                    <path\r\n                                        className={`${styles.spiralArm} ${styles.arm1}`}\r\n                                        d=\"M 0 0 q -20 -60 40 -100 t 80 20\"\r\n                                        fill=\"none\"\r\n                                        stroke=\"currentColor\"\r\n                                        strokeWidth=\"2\"\r\n                                        strokeLinecap=\"round\"\r\n                                    />\r\n                                    <path\r\n                                        className={`${styles.spiralArm} ${styles.arm2}`}\r\n                                        d=\"M 0 0 q 60 -20 100 40 t -20 80\"\r\n                                        fill=\"none\"\r\n                                        stroke=\"currentColor\"\r\n                                        strokeWidth=\"2\"\r\n                                        strokeLinecap=\"round\"\r\n                                    />\r\n                                    <path\r\n                                        className={`${styles.spiralArm} ${styles.arm3}`}\r\n                                        d=\"M 0 0 q 20 60 -40 100 t -80 -20\"\r\n                                        fill=\"none\"\r\n                                        stroke=\"currentColor\"\r\n                                        strokeWidth=\"2\"\r\n                                        strokeLinecap=\"round\"\r\n                                    />\r\n\r\n                                    {/* Star Particles */}\r\n                                    <g className={styles.stars}>\r\n                                        <circle className={styles.star} cx=\"30\" cy=\"-40\" r=\"1.5\" fill=\"white\" />\r\n                                        <circle className={styles.star} cx=\"-50\" cy=\"20\" r=\"1\" fill=\"white\" />\r\n                                        <circle className={styles.star} cx=\"60\" cy=\"50\" r=\"2\" fill=\"white\" />\r\n                                        <circle className={styles.star} cx=\"-20\" cy=\"-70\" r=\"1.2\" fill=\"white\" />\r\n                                        <circle className={styles.star} cx=\"80\" cy=\"-10\" r=\"1.5\" fill=\"white\" />\r\n                                        <circle className={styles.star} cx=\"-40\" cy=\"80\" r=\"1\" fill=\"white\" />\r\n                                    </g>\r\n                                </g>\r\n\r\n                                {/* Glow Circle - Shared position */}\r\n                                <circle\r\n                                    r=\"80\"\r\n                                    fill={region.color}\r\n                                    opacity=\"0.15\"\r\n                                    className={styles.glowCircle}\r\n                                    style={{ stroke: region.color, strokeWidth: 1.5 }}\r\n                                />\r\n                            </g>\r\n\r\n                            <foreignObject\r\n                                x={region.cx - 70}\r\n                                y={region.cy - 70}\r\n                                width=\"140\"\r\n                                height=\"140\"\r\n                                onClick={(e) => handleRegionClick(region, e)}\r\n                            >\r\n                                <div className={styles.iconWrapper}>\r\n                                    <div className={styles.iconContainer} style={{\r\n                                        width: '100px',\r\n                                        height: '100px',\r\n                                        border: `3px solid ${region.color}`,\r\n                                        boxShadow: `0 0 35px ${region.color}99`,\r\n                                    }}>\r\n                                        <img\r\n                                            src={region.thumbUrl}\r\n                                            alt={region.name}\r\n                                            className={styles.iconImage}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </foreignObject>\r\n\r\n                            <text\r\n                                x={region.cx}\r\n                                y={region.cy + 75}\r\n                                className={styles.regionText}\r\n                            >\r\n                                {region.name}\r\n                            </text>\r\n                        </g>\r\n                    ))}\r\n\r\n                    {selectedRegion && selectedRegion.locations.map((loc) => (\r\n                        <g key={loc.id} className={styles.locationMarker} style={{ color: selectedRegion.color }}>\r\n                            <circle cx={loc.cx} cy={loc.cy} r=\"60\" fill={selectedRegion.color} opacity=\"0.1\" className={styles.sonarRing} />\r\n\r\n                            <foreignObject\r\n                                x={loc.cx - 55}\r\n                                y={loc.cy - 55}\r\n                                width=\"110\"\r\n                                height=\"110\"\r\n                                onClick={(e) => handleLocationClick(loc, e)}\r\n                                style={{ cursor: 'pointer' }}\r\n                            >\r\n                                <div className={styles.iconWrapper}>\r\n                                    <div className={styles.iconContainer} style={{\r\n                                        width: '80px',\r\n                                        height: '80px',\r\n                                        border: `2px solid ${selectedRegion.color}`,\r\n                                        boxShadow: `0 0 25px ${selectedRegion.color}99`,\r\n                                    }}>\r\n                                        <img\r\n                                            src={loc.thumbUrl}\r\n                                            alt={loc.name}\r\n                                            className={styles.iconImage}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </foreignObject>\r\n\r\n                            <text\r\n                                x={loc.cx}\r\n                                y={loc.cy + 60}\r\n                                className={styles.locationText}\r\n                            >\r\n                                {loc.name}\r\n                            </text>\r\n                        </g>\r\n                    ))}\r\n                </g>\r\n            </svg>\r\n        </div>\r\n    );\r\n}\r\n","import React, { useState } from 'react';\r\nimport styles from './AdminPortal.module.css';\r\nimport { Region, Location, UniverseConfig } from '@/data/universe-data';\r\n\r\ninterface AdminPortalProps {\r\n    data: Region[];\r\n    config: UniverseConfig;\r\n    onUpdate: (newData: Region[]) => void;\r\n    onConfigUpdate: (config: UniverseConfig) => void;\r\n    onCoordPick: (coords: { x: number; y: number } | null) => void;\r\n    pickedCoords: { x: number; y: number } | null;\r\n    onPickingStateChange?: (isPicking: boolean) => void;\r\n}\r\n\r\nexport default function AdminPortal({ data, config, onUpdate, onConfigUpdate, onCoordPick, pickedCoords, onPickingStateChange }: AdminPortalProps) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [editingRegion, setEditingRegion] = useState<Region | null>(null);\r\n    const [isAddingLocation, setIsAddingLocation] = useState(false);\r\n    const [isPickingUniversePos, setIsPickingUniversePos] = useState(false);\r\n    const [relocatingLocId, setRelocatingLocId] = useState<string | null>(null);\r\n\r\n    const [newLocName, setNewLocName] = useState('');\r\n    const [newLocDesc, setNewLocDesc] = useState('');\r\n\r\n    const handleSaveRegion = (region: Region) => {\r\n        const newData = data.map(r => r.id === region.id ? region : r);\r\n        onUpdate(newData);\r\n        setEditingRegion(region); // Keep details open\r\n    };\r\n\r\n    const handleSaveToFile = async () => {\r\n        try {\r\n            const response = await fetch('/api/save-data', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ config, regions: data }),\r\n            });\r\n            \r\n            const result = await response.json();\r\n            \r\n            if (response.ok) {\r\n                alert('âœ… Changes saved to Supabase successfully!\\n\\nYour lore data is now persistent across all devices.');\r\n            } else {\r\n                if (response.status === 401) {\r\n                    alert('ðŸ”’ Authentication Required\\n\\nYou must be signed in as an admin to save changes.\\n\\nPlease sign in and try again.');\r\n                } else {\r\n                    alert(`âŒ Failed to save changes:\\n\\n${result.error || 'Unknown error'}`);\r\n                }\r\n            }\r\n        } catch (err) {\r\n            console.error('Error saving changes:', err);\r\n            alert('âŒ Error saving changes:\\n\\nPlease check your internet connection and ensure Supabase is configured correctly.');\r\n        }\r\n    };\r\n\r\n    const handleDeleteRegion = (id: string, e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        if (confirm('Are you sure you want to delete this universe?')) {\r\n            onUpdate(data.filter(r => r.id !== id));\r\n            if (editingRegion?.id === id) setEditingRegion(null);\r\n        }\r\n    };\r\n\r\n    const handleAddNewUniverse = () => {\r\n        const id = `univ-${Date.now()}`;\r\n        const newUniv: Region = {\r\n            id,\r\n            name: 'New Universe',\r\n            description: 'A newly discovered realm.',\r\n            color: '#ffffff',\r\n            cx: 500,\r\n            cy: 400,\r\n            thumbUrl: '/images/multiversal-bg.png',\r\n            backgroundUrl: '/images/multiversal-bg.png',\r\n            imageUrl: '/images/multiversal-bg.png',\r\n            locations: []\r\n        };\r\n        onUpdate([...data, newUniv]);\r\n        setEditingRegion(newUniv);\r\n    };\r\n\r\n    const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>, field: 'thumbUrl' | 'backgroundUrl') => {\r\n        const file = e.target.files?.[0];\r\n        if (file && editingRegion) {\r\n            const url = URL.createObjectURL(file);\r\n            setEditingRegion({ ...editingRegion, [field]: url });\r\n        }\r\n    };\r\n\r\n    const handleLocImageUpload = (e: React.ChangeEvent<HTMLInputElement>, locId: string) => {\r\n        const file = e.target.files?.[0];\r\n        if (file && editingRegion) {\r\n            const url = URL.createObjectURL(file);\r\n            const newLocs = editingRegion.locations.map(l => l.id === locId ? { ...l, thumbUrl: url } : l);\r\n            setEditingRegion({ ...editingRegion, locations: newLocs });\r\n        }\r\n    };\r\n\r\n    const toggleRelocate = () => {\r\n        const newState = !isPickingUniversePos;\r\n        setIsPickingUniversePos(newState);\r\n        onPickingStateChange?.(newState);\r\n        if (newState) {\r\n            setIsAddingLocation(false);\r\n        } else {\r\n            onCoordPick(null);\r\n        }\r\n    };\r\n\r\n    const applyNewUniversePos = () => {\r\n        if (!editingRegion || !pickedCoords) return;\r\n        const updated = {\r\n            ...editingRegion,\r\n            cx: Math.round(pickedCoords.x),\r\n            cy: Math.round(pickedCoords.y)\r\n        };\r\n        setEditingRegion(updated);\r\n        handleSaveRegion(updated);\r\n        setIsPickingUniversePos(false);\r\n        onPickingStateChange?.(false);\r\n        onCoordPick(null);\r\n    };\r\n\r\n    const handleAddLocation = () => {\r\n        if (!editingRegion || !pickedCoords) return;\r\n\r\n        const newLoc: Location = {\r\n            id: `loc-${Date.now()}`,\r\n            name: newLocName || 'New Location',\r\n            description: newLocDesc || 'Description',\r\n            cx: Math.round(pickedCoords.x),\r\n            cy: Math.round(pickedCoords.y),\r\n            type: 'station',\r\n            thumbUrl: editingRegion.thumbUrl\r\n        };\r\n\r\n        const updatedRegion = {\r\n            ...editingRegion,\r\n            locations: [...editingRegion.locations, newLoc]\r\n        };\r\n\r\n        setEditingRegion(updatedRegion);\r\n        handleSaveRegion(updatedRegion);\r\n        setIsAddingLocation(false);\r\n        onPickingStateChange?.(false);\r\n        onCoordPick(null);\r\n        setNewLocName('');\r\n        setNewLocDesc('');\r\n    };\r\n\r\n    const toggleLocRelocate = (locId: string) => {\r\n        if (relocatingLocId === locId) {\r\n            setRelocatingLocId(null);\r\n            onPickingStateChange?.(false);\r\n            onCoordPick(null);\r\n        } else {\r\n            setRelocatingLocId(locId);\r\n            setIsAddingLocation(false);\r\n            setIsPickingUniversePos(false);\r\n            onPickingStateChange?.(true);\r\n        }\r\n    };\r\n\r\n    const applyNewLocPos = (locId: string) => {\r\n        if (!editingRegion || !pickedCoords) return;\r\n        const newLocs = editingRegion.locations.map(l =>\r\n            l.id === locId ? { ...l, cx: Math.round(pickedCoords.x), cy: Math.round(pickedCoords.y) } : l\r\n        );\r\n        const updated = { ...editingRegion, locations: newLocs };\r\n        setEditingRegion(updated);\r\n        handleSaveRegion(updated);\r\n        setRelocatingLocId(null);\r\n        onPickingStateChange?.(false);\r\n        onCoordPick(null);\r\n    };\r\n\r\n    const handleGlobalBgUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (file) {\r\n            const url = URL.createObjectURL(file);\r\n            onConfigUpdate({ ...config, multiverseBackgroundUrl: url });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={`${styles.adminContainer} ${isOpen ? styles.open : ''}`}>\r\n            <button className={styles.toggleBtn} onClick={() => setIsOpen(!isOpen)}>\r\n                {isOpen ? 'Close Admin' : 'Admin Portal'}\r\n            </button>\r\n\r\n            {isOpen && (\r\n                <div className={styles.content}>\r\n                    <div className={styles.panelHeader}>\r\n                        <h2>Universe Management</h2>\r\n                        <div className={styles.headerActions}>\r\n                            <button className={styles.addMainBtn} onClick={handleAddNewUniverse}>+ New Universe</button>\r\n                            <button className={styles.saveFileBtn} onClick={handleSaveToFile}>ðŸ’¾ Commit Changes</button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={styles.globalSection}>\r\n                        <h3>Global Settings</h3>\r\n                        <label className={styles.globalLabel}>Multiverse Background\r\n                            <div className={styles.fileInputWrapper}>\r\n                                <input type=\"file\" accept=\"image/*,video/mp4,video/webm,video/quicktime\" onChange={handleGlobalBgUpload} />\r\n                                <div className={styles.previewSmall} style={{ backgroundImage: `url(${config.multiverseBackgroundUrl})` }} />\r\n                            </div>\r\n                        </label>\r\n                    </div>\r\n\r\n                    <div className={styles.list}>\r\n                        {data.map(region => (\r\n                            <div key={region.id} className={`${styles.item} ${editingRegion?.id === region.id ? styles.active : ''}`}>\r\n                                <span>{region.name}</span>\r\n                                <div className={styles.itemActions}>\r\n                                    <button onClick={() => setEditingRegion(region)}>Edit</button>\r\n                                    <button className={styles.deleteBtn} onClick={(e) => handleDeleteRegion(region.id, e)}>Delete</button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {editingRegion && (\r\n                        <div className={styles.editor}>\r\n                            <div className={styles.editorHeader}>\r\n                                <h3>Editing: {editingRegion.name}</h3>\r\n                                <button className={styles.closeEditor} onClick={() => {\r\n                                    setEditingRegion(null);\r\n                                    setIsPickingUniversePos(false);\r\n                                    setIsAddingLocation(false);\r\n                                    setRelocatingLocId(null);\r\n                                    onPickingStateChange?.(false);\r\n                                    onCoordPick(null);\r\n                                }}>Ã—</button>\r\n                            </div>\r\n\r\n                            <div className={styles.editorContent}>\r\n                                <label>Universe Name\r\n                                    <input\r\n                                        value={editingRegion.name}\r\n                                        onChange={e => setEditingRegion({ ...editingRegion, name: e.target.value })}\r\n                                    />\r\n                                </label>\r\n\r\n                                <div className={styles.relocateSection}>\r\n                                    <p>Map Placement: {editingRegion.cx}, {editingRegion.cy}</p>\r\n                                    {!isPickingUniversePos ? (\r\n                                        <button onClick={toggleRelocate}>Relocate on Map</button>\r\n                                    ) : (\r\n                                        <div className={styles.pickMode}>\r\n                                            <p>Click on map below...</p>\r\n                                            <p>New: {pickedCoords ? `${Math.round(pickedCoords.x)}, ${Math.round(pickedCoords.y)}` : '-'}</p>\r\n                                            <button onClick={applyNewUniversePos} disabled={!pickedCoords}>Apply Position</button>\r\n                                            <button onClick={toggleRelocate}>Cancel</button>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n\r\n                                <div className={styles.imageUploads}>\r\n                                    <label>Universe Icon\r\n                                        <div className={styles.fileInputWrapper}>\r\n                                            <input type=\"file\" accept=\"image/*\" onChange={e => handleImageUpload(e, 'thumbUrl')} />\r\n                                            <div className={styles.previewSmall} style={{ backgroundImage: `url(${editingRegion.thumbUrl})` }} />\r\n                                        </div>\r\n                                    </label>\r\n\r\n                                    <label>Background Image\r\n                                        <div className={styles.fileInputWrapper}>\r\n                                            <input type=\"file\" accept=\"image/*,video/mp4,video/webm,video/quicktime\" onChange={e => handleImageUpload(e, 'backgroundUrl')} />\r\n\r\n                                            <div className={styles.previewSmall} style={{ backgroundImage: `url(${editingRegion.backgroundUrl})` }} />\r\n                                        </div>\r\n                                    </label>\r\n                                </div>\r\n\r\n                                <div className={styles.locationList}>\r\n                                    <h4>Local Points</h4>\r\n                                    {editingRegion.locations.map(loc => (\r\n                                        <div key={loc.id} className={styles.locItemEditor}>\r\n                                            <div className={styles.locRow}>\r\n                                                <input\r\n                                                    value={loc.name}\r\n                                                    onChange={e => {\r\n                                                        const newLocs = editingRegion.locations.map(l => l.id === loc.id ? { ...l, name: e.target.value } : l);\r\n                                                        setEditingRegion({ ...editingRegion, locations: newLocs });\r\n                                                    }}\r\n                                                />\r\n                                                <select\r\n                                                    value={loc.type}\r\n                                                    onChange={e => {\r\n                                                        const newLocs = editingRegion.locations.map(l => l.id === loc.id ? { ...l, type: e.target.value as any } : l);\r\n                                                        setEditingRegion({ ...editingRegion, locations: newLocs });\r\n                                                    }}\r\n                                                >\r\n                                                    <option value=\"planet\">Planet</option>\r\n                                                    <option value=\"station\">Station</option>\r\n                                                    <option value=\"anomaly\">Anomaly</option>\r\n                                                </select>\r\n                                                <button className={styles.deleteLocBtn} onClick={() => {\r\n                                                    const newLocs = editingRegion.locations.filter(l => l.id !== loc.id);\r\n                                                    setEditingRegion({ ...editingRegion, locations: newLocs });\r\n                                                }}>Ã—</button>\r\n                                            </div>\r\n                                            <div className={styles.locRow}>\r\n                                                <textarea\r\n                                                    className={styles.locDescArea}\r\n                                                    value={loc.description}\r\n                                                    placeholder=\"Description\"\r\n                                                    onChange={e => {\r\n                                                        const newLocs = editingRegion.locations.map(l => l.id === loc.id ? { ...l, description: e.target.value } : l);\r\n                                                        setEditingRegion({ ...editingRegion, locations: newLocs });\r\n                                                    }}\r\n                                                />\r\n                                            </div>\r\n                                            <div className={styles.locRow}>\r\n                                                <label className={styles.locThumbLabel}>\r\n                                                    Thumb\r\n                                                    <input type=\"file\" accept=\"image/*\" onChange={e => handleLocImageUpload(e, loc.id)} />\r\n                                                </label>\r\n                                                <div className={styles.locPreview} style={{ backgroundImage: `url(${loc.thumbUrl})` }} />\r\n                                            </div>\r\n\r\n                                            <div className={styles.locRelocateRow}>\r\n                                                <p>Pos: {loc.cx}, {loc.cy}</p>\r\n                                                {relocatingLocId !== loc.id ? (\r\n                                                    <button className={styles.miniRelocateBtn} onClick={() => toggleLocRelocate(loc.id)}>Relocate</button>\r\n                                                ) : (\r\n                                                    <div className={styles.miniPickMode}>\r\n                                                        <span>New: {pickedCoords ? `${Math.round(pickedCoords.x)}, ${Math.round(pickedCoords.y)}` : '-'}</span>\r\n                                                        <button onClick={() => applyNewLocPos(loc.id)} disabled={!pickedCoords}>Set</button>\r\n                                                        <button onClick={() => toggleLocRelocate(loc.id)}>Cancel</button>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n\r\n                                {!isAddingLocation ? (\r\n                                    <button className={styles.addPointBtn} onClick={() => {\r\n                                        setIsAddingLocation(true);\r\n                                        setIsPickingUniversePos(false);\r\n                                        onPickingStateChange?.(true);\r\n                                    }}>+ Add Point</button>\r\n                                ) : (\r\n                                    <div className={styles.addLocForm}>\r\n                                        <p>Click map to pick coords</p>\r\n                                        <p>Point: {pickedCoords ? `${Math.round(pickedCoords.x)}, ${Math.round(pickedCoords.y)}` : '-'}</p>\r\n                                        <input placeholder=\"Name\" value={newLocName} onChange={e => setNewLocName(e.target.value)} />\r\n                                        <textarea placeholder=\"Description\" value={newLocDesc} onChange={e => setNewLocDesc(e.target.value)} />\r\n                                        <div className={styles.addLocActions}>\r\n                                            <button className={styles.confirmBtn} onClick={handleAddLocation} disabled={!pickedCoords}>Confirm Point</button>\r\n                                            <button className={styles.cancelBtn} onClick={() => {\r\n                                                setIsAddingLocation(false);\r\n                                                onPickingStateChange?.(false);\r\n                                            }}>Cancel</button>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                <div className={styles.editorFooter}>\r\n                                    <button className={styles.saveBtn} onClick={() => handleSaveRegion(editingRegion)}>Apply All Local Changes</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","\r\nimport React from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { Location } from '@/data/universe-data';\r\nimport styles from './LocalPointOverlay.module.css';\r\n\r\ninterface LocalPointOverlayProps {\r\n    location: Location | null;\r\n    origin: { x: number; y: number } | null;\r\n    regionColor: string;\r\n    onClose: () => void;\r\n}\r\n\r\nexport default function LocalPointOverlay({ location, origin, regionColor, onClose }: LocalPointOverlayProps) {\r\n    if (!origin) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <AnimatePresence>\r\n            {location && (\r\n                <>\r\n                    {/* Backdrop */}\r\n                    <motion.div\r\n                        className={styles.backdrop}\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        onClick={onClose}\r\n                    />\r\n\r\n                    {/* Expanding Overlay */}\r\n                    <motion.div\r\n                        className={styles.overlay}\r\n                        style={{\r\n                            '--origin-x': `${origin.x}px`,\r\n                            '--origin-y': `${origin.y}px`,\r\n                            '--accent-color': regionColor,\r\n                        } as React.CSSProperties}\r\n                        initial={{\r\n                            opacity: 0,\r\n                            scale: 0.1,\r\n                            x: origin.x - window.innerWidth / 2,\r\n                            y: origin.y - window.innerHeight / 2\r\n                        }}\r\n                        animate={{\r\n                            opacity: 1,\r\n                            scale: 1,\r\n                            x: 0,\r\n                            y: 0\r\n                        }}\r\n                        exit={{\r\n                            opacity: 0,\r\n                            scale: 0.1,\r\n                            x: origin.x - window.innerWidth / 2,\r\n                            y: origin.y - window.innerHeight / 2\r\n                        }}\r\n                        transition={{\r\n                            type: \"spring\",\r\n                            stiffness: 200,\r\n                            damping: 25\r\n                        }}\r\n                    >\r\n                        <button onClick={onClose} className={styles.closeButton}>\r\n                            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\r\n                                <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\r\n                            </svg>\r\n                        </button>\r\n\r\n                        <div className={styles.content}>\r\n                            <div className={styles.imageContainer}>\r\n                                {/* eslint-disable-next-line @next/next/no-img-element */}\r\n                                <img\r\n                                    src={location.thumbUrl}\r\n                                    alt={location.name}\r\n                                    className={styles.image}\r\n                                />\r\n                            </div>\r\n\r\n                            <h2 className={styles.title}>{location.name}</h2>\r\n                            <p className={styles.description}>{location.description}</p>\r\n\r\n                            <div className={styles.metaSection}>\r\n                                <div className={styles.metaItem}>\r\n                                    <span>Point ID</span>\r\n                                    <span className={styles.metaValue}>{location.id.toUpperCase()}</span>\r\n                                </div>\r\n                                <div className={styles.metaItem}>\r\n                                    <span>Type</span>\r\n                                    <span className={styles.metaValue}>{location.type.toUpperCase()}</span>\r\n                                </div>\r\n                                <div className={styles.metaItem}>\r\n                                    <span>Coordinates</span>\r\n                                    <span className={styles.metaValue}>{location.cx}, {location.cy}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </motion.div>\r\n                </>\r\n            )}\r\n        </AnimatePresence>\r\n    );\r\n}\r\n","export interface Location {\n  id: string;\n  name: string;\n  description: string;\n  cx: number;\n  cy: number;\n  type: 'planet' | 'station' | 'anomaly';\n  thumbUrl: string;\n}\n\nexport interface Region {\n  id: string;\n  name: string;\n  description: string;\n  path?: string;\n  color: string;\n  cx: number;\n  cy: number;\n  thumbUrl: string;\n  backgroundUrl: string;\n  imageUrl: string;\n  locations: Location[];\n}\n\nexport interface UniverseConfig {\n  multiverseBackgroundUrl: string;\n}\n\nexport const CONFIG: UniverseConfig = {\n  multiverseBackgroundUrl: \"/videos/Lore%20Background.mp4\"\n};\n\nexport const UNIVERSE_DATA: Region[] = [\n  {\n    \"id\": \"nebula-prime\",\n    \"name\": \"ALPHA ONE\",\n    \"description\": \"The central hub of the galaxy, teeming with trade and ancient technology.\",\n    \"color\": \"#4f46e5\",\n    \"cx\": 500,\n    \"cy\": 300,\n    \"thumbUrl\": \"/images/nebula-prime-thumb.png\",\n    \"backgroundUrl\": \"/images/nebula-prime.png\",\n    \"imageUrl\": \"/images/nebula-prime.png\",\n    \"locations\": [\n      {\n        \"id\": \"prime-core\",\n        \"name\": \"The Core\",\n        \"description\": \"Central command of the hub.\",\n        \"cx\": 400,\n        \"cy\": 350,\n        \"type\": \"station\",\n        \"thumbUrl\": \"/images/nebula-prime-thumb.png\"\n      },\n      {\n        \"id\": \"trading-outpost\",\n        \"name\": \"Outpost 7\",\n        \"description\": \"Busy trading post.\",\n        \"cx\": 600,\n        \"cy\": 250,\n        \"type\": \"station\",\n        \"thumbUrl\": \"/images/nebula-prime-thumb.png\"\n      },\n      {\n        \"id\": \"ancient-shard\",\n        \"name\": \"Ancient Shard\",\n        \"description\": \"Mysterious artifact floating in space.\",\n        \"cx\": 500,\n        \"cy\": 500,\n        \"type\": \"anomaly\",\n        \"thumbUrl\": \"/images/nebula-prime-thumb.png\"\n      }\n    ]\n  },\n  {\n    \"id\": \"cryo-wastes\",\n    \"name\": \"Cryo Wastes\",\n    \"description\": \"A frozen sector where entropy has slowed time itself.\",\n    \"color\": \"#06b6d4\",\n    \"cx\": 200,\n    \"cy\": 200,\n    \"thumbUrl\": \"/images/cryo-wastes.png\",\n    \"backgroundUrl\": \"/images/cryo-wastes.png\",\n    \"imageUrl\": \"/images/cryo-wastes.png\",\n    \"locations\": [\n      {\n        \"id\": \"ice-citadel\",\n        \"name\": \"Ice Base\",\n        \"description\": \"A fortress built into a moon.\",\n        \"cx\": 150,\n        \"cy\": 150,\n        \"type\": \"planet\",\n        \"thumbUrl\": \"/images/cryo-wastes.png\"\n      },\n      {\n        \"id\": \"frozen-wreck\",\n        \"name\": \"Frozen Wreck\",\n        \"description\": \"A ship lost to the ice.\",\n        \"cx\": 250,\n        \"cy\": 250,\n        \"type\": \"anomaly\",\n        \"thumbUrl\": \"/images/cryo-wastes.png\"\n      }\n    ]\n  },\n  {\n    \"id\": \"magma-forge\",\n    \"name\": \"Magma Forge\",\n    \"description\": \"Industrial core mining heavy elements from dying stars.\",\n    \"color\": \"#ef4444\",\n    \"cx\": 800,\n    \"cy\": 600,\n    \"thumbUrl\": \"/images/magma-forge.png\",\n    \"backgroundUrl\": \"/images/magma-forge.png\",\n    \"imageUrl\": \"/images/magma-forge.png\",\n    \"locations\": [\n      {\n        \"id\": \"smelter-complex\",\n        \"name\": \"Smelter Complex\",\n        \"description\": \"Primary refining station.\",\n        \"cx\": 750,\n        \"cy\": 550,\n        \"type\": \"station\",\n        \"thumbUrl\": \"/images/magma-forge.png\"\n      },\n      {\n        \"id\": \"lava-extraction\",\n        \"name\": \"Extraction Site B\",\n        \"description\": \"Mining operation in the magma rivers.\",\n        \"cx\": 850,\n        \"cy\": 650,\n        \"type\": \"planet\",\n        \"thumbUrl\": \"/images/magma-forge.png\"\n      }\n    ]\n  },\n  {\n    \"id\": \"void-expanse\",\n    \"name\": \"Void Expanse\",\n    \"description\": \"Mysterious dark matter cloud. Enter at your own risk.\",\n    \"color\": \"#8b5cf6\",\n    \"cx\": 850,\n    \"cy\": 150,\n    \"thumbUrl\": \"/images/void-expanse.png\",\n    \"backgroundUrl\": \"/images/void-expanse.png\",\n    \"imageUrl\": \"/images/void-expanse.png\",\n    \"locations\": [\n      {\n        \"id\": \"dark-anchor\",\n        \"name\": \"Dark Anchor\",\n        \"description\": \"Stable point in the void.\",\n        \"cx\": 800,\n        \"cy\": 100,\n        \"type\": \"anomaly\",\n        \"thumbUrl\": \"/images/void-expanse.png\"\n      },\n      {\n        \"id\": \"void-eye\",\n        \"name\": \"The Eye\",\n        \"description\": \"Silent observation post.\",\n        \"cx\": 900,\n        \"cy\": 200,\n        \"type\": \"station\",\n        \"thumbUrl\": \"/images/void-expanse.png\"\n      }\n    ]\n  },\n  {\n    \"id\": \"univ-1767135380112\",\n    \"name\": \"ALPHA ONE\",\n    \"description\": \"A newly discovered realm.\",\n    \"color\": \"#ffffff\",\n    \"cx\": 500,\n    \"cy\": 400,\n    \"thumbUrl\": \"/images/multiversal-bg.png\",\n    \"backgroundUrl\": \"/images/multiversal-bg.png\",\n    \"imageUrl\": \"/images/multiversal-bg.png\",\n    \"locations\": []\n  },\n  {\n    \"id\": \"univ-1767136475924\",\n    \"name\": \"Test Universe\",\n    \"description\": \"A newly discovered realm.\",\n    \"color\": \"#ffffff\",\n    \"cx\": 500,\n    \"cy\": 400,\n    \"thumbUrl\": \"/images/multiversal-bg.png\",\n    \"backgroundUrl\": \"/images/multiversal-bg.png\",\n    \"imageUrl\": \"/images/multiversal-bg.png\",\n    \"locations\": []\n  }\n];\n","import { createClient } from '@supabase/supabase-js';\r\n\r\n// Supabase configuration - Using Vite environment variables\r\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\r\nconst supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  throw new Error(\r\n    'Missing Supabase environment variables. Please check your .env.local file.'\r\n  );\r\n}\r\n\r\n// Create Supabase client\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\r\n  auth: {\r\n    persistSession: true,\r\n    autoRefreshToken: true,\r\n  },\r\n});\r\n\r\n// =====================================================\r\n// TYPE DEFINITIONS\r\n// =====================================================\r\n\r\nexport interface LoreLocation {\r\n  id: string;\r\n  location_id: string;\r\n  region_id: string;\r\n  name: string;\r\n  description: string;\r\n  cx: number;\r\n  cy: number;\r\n  location_type: 'planet' | 'station' | 'anomaly';\r\n  thumb_url: string;\r\n  sort_order: number;\r\n  is_active: boolean;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nexport interface LoreRegion {\r\n  id: string;\r\n  region_id: string;\r\n  name: string;\r\n  description: string;\r\n  color: string;\r\n  cx: number;\r\n  cy: number;\r\n  thumb_url: string;\r\n  background_url: string;\r\n  image_url: string;\r\n  sort_order: number;\r\n  is_active: boolean;\r\n  created_at: string;\r\n  updated_at: string;\r\n  locations?: LoreLocation[];\r\n}\r\n\r\nexport interface LoreConfig {\r\n  id: string;\r\n  config_key: string;\r\n  config_value: {\r\n    multiverseBackgroundUrl: string;\r\n  };\r\n  description?: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\n// =====================================================\r\n// PUBLIC READ FUNCTIONS\r\n// =====================================================\r\n\r\n/**\r\n * Fetch all active regions with their locations\r\n */\r\nexport async function fetchRegions(): Promise<LoreRegion[]> {\r\n  const { data: regions, error: regionsError } = await supabase\r\n    .from('lore_regions')\r\n    .select('*')\r\n    .eq('is_active', true)\r\n    .order('sort_order', { ascending: true });\r\n\r\n  if (regionsError) {\r\n    console.error('Error fetching regions:', regionsError);\r\n    throw regionsError;\r\n  }\r\n\r\n  if (!regions || regions.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  // Fetch all locations for these regions\r\n  const { data: locations, error: locationsError } = await supabase\r\n    .from('lore_locations')\r\n    .select('*')\r\n    .eq('is_active', true)\r\n    .order('sort_order', { ascending: true });\r\n\r\n  if (locationsError) {\r\n    console.error('Error fetching locations:', locationsError);\r\n    throw locationsError;\r\n  }\r\n\r\n  // Group locations by region\r\n  const regionsWithLocations = regions.map((region) => ({\r\n    ...region,\r\n    locations: locations?.filter((loc) => loc.region_id === region.id) || [],\r\n  }));\r\n\r\n  return regionsWithLocations;\r\n}\r\n\r\n/**\r\n * Fetch lore system configuration\r\n */\r\nexport async function fetchLoreConfig(): Promise<LoreConfig | null> {\r\n  const { data, error } = await supabase\r\n    .from('lore_config')\r\n    .select('*')\r\n    .eq('config_key', 'multiverse_background')\r\n    .single();\r\n\r\n  if (error) {\r\n    console.error('Error fetching lore config:', error);\r\n    return null;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\n// =====================================================\r\n// ADMIN WRITE FUNCTIONS (Require Authentication)\r\n// =====================================================\r\n\r\n/**\r\n * Upsert a region (admin only)\r\n */\r\nexport async function upsertRegion(region: {\r\n  region_id: string;\r\n  name: string;\r\n  description: string;\r\n  color: string;\r\n  cx: number;\r\n  cy: number;\r\n  thumb_url: string;\r\n  background_url: string;\r\n  image_url: string;\r\n  sort_order?: number;\r\n}): Promise<string> {\r\n  const { data, error } = await supabase.rpc('upsert_lore_region', {\r\n    p_region_id: region.region_id,\r\n    p_name: region.name,\r\n    p_description: region.description,\r\n    p_color: region.color,\r\n    p_cx: region.cx,\r\n    p_cy: region.cy,\r\n    p_thumb_url: region.thumb_url,\r\n    p_background_url: region.background_url,\r\n    p_image_url: region.image_url,\r\n    p_sort_order: region.sort_order || 0,\r\n  });\r\n\r\n  if (error) {\r\n    console.error('Error upserting region:', error);\r\n    throw error;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\n/**\r\n * Upsert a location (admin only)\r\n */\r\nexport async function upsertLocation(location: {\r\n  location_id: string;\r\n  region_id: string;\r\n  name: string;\r\n  description: string;\r\n  cx: number;\r\n  cy: number;\r\n  location_type: 'planet' | 'station' | 'anomaly';\r\n  thumb_url: string;\r\n  sort_order?: number;\r\n}): Promise<string> {\r\n  const { data, error } = await supabase.rpc('upsert_lore_location', {\r\n    p_location_id: location.location_id,\r\n    p_region_id: location.region_id,\r\n    p_name: location.name,\r\n    p_description: location.description,\r\n    p_cx: location.cx,\r\n    p_cy: location.cy,\r\n    p_location_type: location.location_type,\r\n    p_thumb_url: location.thumb_url,\r\n    p_sort_order: location.sort_order || 0,\r\n  });\r\n\r\n  if (error) {\r\n    console.error('Error upserting location:', error);\r\n    throw error;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\n/**\r\n * Update lore configuration (admin only)\r\n */\r\nexport async function updateLoreConfig(\r\n  configValue: { multiverseBackgroundUrl: string }\r\n): Promise<string> {\r\n  const { data, error } = await supabase.rpc('update_lore_config', {\r\n    p_config_key: 'multiverse_background',\r\n    p_config_value: configValue,\r\n  });\r\n\r\n  if (error) {\r\n    console.error('Error updating lore config:', error);\r\n    throw error;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\n/**\r\n * Delete a region (admin only - soft delete)\r\n */\r\nexport async function deleteRegion(regionId: string): Promise<boolean> {\r\n  const { data, error } = await supabase.rpc('delete_lore_region', {\r\n    p_region_id: regionId,\r\n  });\r\n\r\n  if (error) {\r\n    console.error('Error deleting region:', error);\r\n    throw error;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\n/**\r\n * Delete a location (admin only - soft delete)\r\n */\r\nexport async function deleteLocation(locationId: string): Promise<boolean> {\r\n  const { data, error } = await supabase.rpc('delete_lore_location', {\r\n    p_location_id: locationId,\r\n  });\r\n\r\n  if (error) {\r\n    console.error('Error deleting location:', error);\r\n    throw error;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\n// =====================================================\r\n// BATCH OPERATIONS\r\n// =====================================================\r\n\r\n/**\r\n * Bulk upsert regions and locations (admin only)\r\n * Useful for importing data from the old localStorage system\r\n */\r\nexport async function bulkUpsertData(\r\n  regions: Array<{\r\n    region_id: string;\r\n    name: string;\r\n    description: string;\r\n    color: string;\r\n    cx: number;\r\n    cy: number;\r\n    thumb_url: string;\r\n    background_url: string;\r\n    image_url: string;\r\n    locations: Array<{\r\n      location_id: string;\r\n      name: string;\r\n      description: string;\r\n      cx: number;\r\n      cy: number;\r\n      location_type: 'planet' | 'station' | 'anomaly';\r\n      thumb_url: string;\r\n    }>;\r\n  }>\r\n): Promise<void> {\r\n  try {\r\n    // Upsert regions first\r\n    for (const region of regions) {\r\n      await upsertRegion({\r\n        region_id: region.region_id,\r\n        name: region.name,\r\n        description: region.description,\r\n        color: region.color,\r\n        cx: region.cx,\r\n        cy: region.cy,\r\n        thumb_url: region.thumb_url,\r\n        background_url: region.background_url,\r\n        image_url: region.image_url,\r\n      });\r\n\r\n      // Then upsert locations for this region\r\n      for (const location of region.locations) {\r\n        await upsertLocation({\r\n          location_id: location.location_id,\r\n          region_id: region.region_id,\r\n          name: location.name,\r\n          description: location.description,\r\n          cx: location.cx,\r\n          cy: location.cy,\r\n          location_type: location.location_type,\r\n          thumb_url: location.thumb_url,\r\n        });\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.error('Error in bulk upsert:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// =====================================================\r\n// AUTHENTICATION HELPERS\r\n// =====================================================\r\n\r\n/**\r\n * Check if user is authenticated\r\n */\r\nexport async function isAuthenticated(): Promise<boolean> {\r\n  const { data: { session } } = await supabase.auth.getSession();\r\n  return !!session;\r\n}\r\n\r\n/**\r\n * Get current user\r\n */\r\nexport async function getCurrentUser() {\r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  return user;\r\n}\r\n\r\n/**\r\n * Sign in with email\r\n */\r\nexport async function signIn(email: string, password: string) {\r\n  const { data, error } = await supabase.auth.signInWithPassword({\r\n    email,\r\n    password,\r\n  });\r\n\r\n  if (error) throw error;\r\n  return data;\r\n}\r\n\r\n/**\r\n * Sign out\r\n */\r\nexport async function signOut() {\r\n  const { error } = await supabase.auth.signOut();\r\n  if (error) throw error;\r\n}\r\n\r\n","import { useState, useEffect, useRef } from \"react\";\r\nimport UniverseMap from \"@/components/UniverseMap/UniverseMap\";\r\nimport AdminPortal from \"@/components/AdminPortal/AdminPortal\";\r\nimport LocalPointOverlay from \"@/components/LocalPointOverlay/LocalPointOverlay\";\r\nimport { Region, Location, UNIVERSE_DATA, CONFIG, UniverseConfig } from \"@/data/universe-data\";\r\nimport { fetchRegions, fetchLoreConfig } from \"@/lib/supabase\";\r\n\r\nexport default function App() {\r\n  const [selectedRegion, setSelectedRegion] = useState<Region | null>(null);\r\n  const [selectedLocation, setSelectedLocation] = useState<Location | null>(null);\r\n  const [locationOrigin, setLocationOrigin] = useState<{ x: number; y: number } | null>(null);\r\n  const [universeData, setUniverseData] = useState<Region[]>(UNIVERSE_DATA);\r\n  const [config, setConfig] = useState<UniverseConfig>(CONFIG);\r\n  const [pickedCoords, setPickedCoords] = useState<{ x: number; y: number } | null>(null);\r\n  const [isPicking, setIsPicking] = useState(false);\r\n  const [isHydrated, setIsHydrated] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const zoomResetRef = useRef<(() => void) | null>(null);\r\n\r\n  // Load data on mount - priority: Supabase > localStorage > fallback\r\n  useEffect(() => {\r\n    async function loadData() {\r\n      try {\r\n        // Try to load from Supabase first\r\n        const [regionsData, configData] = await Promise.all([\r\n          fetchRegions(),\r\n          fetchLoreConfig(),\r\n        ]);\r\n\r\n        if (regionsData && regionsData.length > 0) {\r\n          // Transform Supabase data to match component format\r\n          const transformedRegions = regionsData.map((region: any) => ({\r\n            id: region.region_id,\r\n            name: region.name,\r\n            description: region.description,\r\n            color: region.color,\r\n            cx: region.cx,\r\n            cy: region.cy,\r\n            thumbUrl: region.thumb_url,\r\n            backgroundUrl: region.background_url,\r\n            imageUrl: region.image_url,\r\n            locations: (region.locations || []).map((loc: any) => ({\r\n              id: loc.location_id,\r\n              name: loc.name,\r\n              description: loc.description,\r\n              cx: loc.cx,\r\n              cy: loc.cy,\r\n              type: loc.location_type,\r\n              thumbUrl: loc.thumb_url,\r\n            })),\r\n          }));\r\n          setUniverseData(transformedRegions);\r\n          console.log('âœ… Loaded data from Supabase');\r\n        } else {\r\n          // Fallback to localStorage if Supabase is empty\r\n          const savedData = localStorage.getItem('universeData');\r\n          if (savedData) {\r\n            setUniverseData(JSON.parse(savedData));\r\n            console.log('ðŸ“¦ Loaded data from localStorage');\r\n          } else {\r\n            console.log('ðŸ“‹ Using default fallback data');\r\n          }\r\n        }\r\n\r\n        if (configData) {\r\n          setConfig(configData.config_value);\r\n          console.log('âœ… Loaded config from Supabase');\r\n        } else {\r\n          const savedConfig = localStorage.getItem('universeConfig');\r\n          if (savedConfig) {\r\n            setConfig(JSON.parse(savedConfig));\r\n            console.log('ðŸ“¦ Loaded config from localStorage');\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading data from Supabase:', error);\r\n        // Fallback to localStorage on error\r\n        const savedData = localStorage.getItem('universeData');\r\n        const savedConfig = localStorage.getItem('universeConfig');\r\n        \r\n        if (savedData) {\r\n          try {\r\n            setUniverseData(JSON.parse(savedData));\r\n            console.log('ðŸ“¦ Fallback: Loaded data from localStorage');\r\n          } catch (e) {\r\n            console.error('Failed to parse saved universe data:', e);\r\n          }\r\n        }\r\n\r\n        if (savedConfig) {\r\n          try {\r\n            setConfig(JSON.parse(savedConfig));\r\n            console.log('ðŸ“¦ Fallback: Loaded config from localStorage');\r\n          } catch (e) {\r\n            console.error('Failed to parse saved config:', e);\r\n          }\r\n        }\r\n      } finally {\r\n        setIsLoading(false);\r\n        setIsHydrated(true);\r\n      }\r\n    }\r\n\r\n    loadData();\r\n  }, []);\r\n\r\n  // Keep localStorage in sync as backup (but Supabase is primary)\r\n  useEffect(() => {\r\n    if (isHydrated) {\r\n      localStorage.setItem('universeData', JSON.stringify(universeData));\r\n    }\r\n  }, [universeData, isHydrated]);\r\n\r\n  useEffect(() => {\r\n    if (isHydrated) {\r\n      localStorage.setItem('universeConfig', JSON.stringify(config));\r\n    }\r\n  }, [config, isHydrated]);\r\n\r\n  // Sync state if a region is selected and data changes\r\n  const activeRegion = selectedRegion\r\n    ? universeData.find(r => r.id === selectedRegion.id) || null\r\n    : null;\r\n\r\n  const handleLocationSelect = (loc: Location, screenPos: { x: number; y: number }) => {\r\n    setSelectedLocation(loc);\r\n    setLocationOrigin(screenPos);\r\n  };\r\n\r\n  const handleLocationClose = () => {\r\n    setSelectedLocation(null);\r\n    setLocationOrigin(null);\r\n    // Zoom back to universe level\r\n    zoomResetRef.current?.();\r\n  };\r\n\r\n  // Show loading state\r\n  if (isLoading) {\r\n    return (\r\n      <main className=\"flex items-center justify-center min-h-screen bg-black\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500 mx-auto mb-4\"></div>\r\n          <p className=\"text-white text-lg\">Loading Universe Map...</p>\r\n        </div>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main>\r\n      <UniverseMap\r\n        onRegionSelect={setSelectedRegion}\r\n        selectedRegion={activeRegion}\r\n        universeData={universeData}\r\n        onCoordPick={isPicking ? setPickedCoords : undefined}\r\n        baseBackground={config.multiverseBackgroundUrl}\r\n        onLocationSelect={handleLocationSelect}\r\n        onLocationClose={handleLocationClose}\r\n        zoomResetRef={zoomResetRef}\r\n      />\r\n\r\n      <LocalPointOverlay\r\n        location={selectedLocation}\r\n        origin={locationOrigin}\r\n        regionColor={activeRegion?.color || '#6366f1'}\r\n        onClose={handleLocationClose}\r\n      />\r\n\r\n      <AdminPortal\r\n        data={universeData}\r\n        config={config}\r\n        onUpdate={setUniverseData}\r\n        onConfigUpdate={setConfig}\r\n        onCoordPick={setPickedCoords}\r\n        pickedCoords={pickedCoords}\r\n        onPickingStateChange={setIsPicking}\r\n      />\r\n    </main>\r\n  );\r\n}\r\n\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport App from './App';\r\nimport './index.css';\r\n\r\nReactDOM.createRoot(document.getElementById('root')!).render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>\r\n);\r\n\r\n"],"names":["m","require$$0","client","UniverseMap","onRegionSelect","selectedRegion","universeData","onCoordPick","baseBackground","onLocationSelect","onLocationClose","zoomResetRef","svgRef","useRef","gRef","zoomBehavior","useEffect","svg","d3.select","g","zoom","d3.zoom","event","resetZoomState","initialTransform","d3.zoomIdentity","d3.easeCubicInOut","zoomToUniverse","useCallback","region","transform","handleRegionClick","handleMapClick","x","y","d3.pointer","handleLocationClick","loc","screenX","screenY","handleBack","e","jsxs","styles","jsx","AnimatePresence","motion","bgUrl","AdminPortal","data","config","onUpdate","onConfigUpdate","pickedCoords","onPickingStateChange","isOpen","setIsOpen","useState","editingRegion","setEditingRegion","isAddingLocation","setIsAddingLocation","isPickingUniversePos","setIsPickingUniversePos","relocatingLocId","setRelocatingLocId","newLocName","setNewLocName","newLocDesc","setNewLocDesc","handleSaveRegion","newData","r","handleSaveToFile","response","result","err","handleDeleteRegion","id","handleAddNewUniverse","newUniv","handleImageUpload","field","file","url","handleLocImageUpload","locId","newLocs","l","toggleRelocate","newState","applyNewUniversePos","updated","handleAddLocation","newLoc","updatedRegion","toggleLocRelocate","applyNewLocPos","handleGlobalBgUpload","LocalPointOverlay","location","origin","regionColor","onClose","Fragment","CONFIG","UNIVERSE_DATA","supabaseUrl","supabaseAnonKey","supabase","createClient","fetchRegions","regions","regionsError","locations","locationsError","fetchLoreConfig","error","App","setSelectedRegion","selectedLocation","setSelectedLocation","locationOrigin","setLocationOrigin","setUniverseData","setConfig","setPickedCoords","isPicking","setIsPicking","isHydrated","setIsHydrated","isLoading","setIsLoading","loadData","regionsData","configData","transformedRegions","savedData","savedConfig","activeRegion","handleLocationSelect","screenPos","handleLocationClose","ReactDOM","React"],"mappings":"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","x_google_ignoreList":[0]}