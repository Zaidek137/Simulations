import{j as e,A as F,m as P}from"./framer-motion-BF-rpg2a.js";import{a as Z,r as m,R as Q}from"./react-vendor-DghaKJPf.js";import{s as O,z as ee,i as W,c as T,p as te}from"./d3-vendor-DXMZTTbz.js";import{c as se}from"./supabase-vendor-CHnXwgyT.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))x(d);new MutationObserver(d=>{for(const i of d)if(i.type==="childList")for(const g of i.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&x(g)}).observe(document,{childList:!0,subtree:!0});function j(d){const i={};return d.integrity&&(i.integrity=d.integrity),d.referrerPolicy&&(i.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?i.credentials="include":d.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function x(d){if(d.ep)return;d.ep=!0;const i=j(d);fetch(d.href,i)}})();var H={},J=Z;H.createRoot=J.createRoot,H.hydrateRoot=J.hydrateRoot;const ne="_container_12ims_1",ae="_backgroundLayer_12ims_17",oe="_backgroundVideo_12ims_55",ie="_backgroundDimmer_12ims_81",re="_svg_12ims_103",ce="_pickingMode_12ims_127",le="_universeIcon_12ims_135",de="_spiralArms_12ims_161",me="_spiralArm_12ims_161",ue="_arm1_12ims_189",pe="_arm2_12ims_197",ge="_arm3_12ims_205",he="_stars_12ims_259",xe="_star_12ims_259",fe="_iconWrapper_12ims_301",ye="_iconContainer_12ims_317",ve="_iconImage_12ims_341",_e="_locationMarker_12ims_357",be="_regionText_12ims_365",je="_glowCircle_12ims_437",we="_backButton_12ims_451",Ne="_locationText_12ims_545",ke="_sonarRing_12ims_603",r={container:ne,backgroundLayer:ae,backgroundVideo:oe,backgroundDimmer:ie,svg:re,pickingMode:ce,universeIcon:le,spiralArms:de,spiralArm:me,arm1:ue,arm2:pe,arm3:ge,stars:he,star:xe,iconWrapper:fe,iconContainer:ye,iconImage:ve,locationMarker:_e,regionText:be,glowCircle:je,backButton:we,locationText:Ne,sonarRing:ke};function Le({onRegionSelect:l,selectedRegion:o,universeData:j,onCoordPick:x,baseBackground:d="/images/multiversal-bg.png",onLocationSelect:i,onLocationClose:g,zoomResetRef:_}){const y=m.useRef(null),a=m.useRef(null),u=m.useRef(null);m.useEffect(()=>{if(!y.current||!a.current)return;const s=O(y.current),p=O(a.current),w=ee().scaleExtent([.5,4]).on("zoom",S=>{p.attr("transform",S.transform)});u.current=w,s.call(w),M()},[]);const M=()=>{if(!y.current||!u.current)return;const s=O(y.current),p=W.translate(window.innerWidth/2,window.innerHeight/2).scale(.8).translate(-500,-400);s.transition().duration(1200).ease(T).call(u.current.transform,p)},k=m.useCallback(s=>{if(!y.current||!u.current)return;const p=O(y.current),S=W.translate(window.innerWidth/2,window.innerHeight/2).scale(1.2).translate(-s.cx,-s.cy);p.transition().duration(1200).ease(T).call(u.current.transform,S)},[]);m.useEffect(()=>(_&&o&&(_.current=()=>k(o)),()=>{_&&(_.current=null)}),[_,o,k]);const E=(s,p)=>{p.stopPropagation(),l(s),k(s)},L=s=>{if(a.current){if(x){const[p,w]=te(s,a.current);x({x:p,y:w})}o||l(null)}},R=(s,p)=>{if(p.stopPropagation(),!i||!y.current||!u.current)return;const w=p.clientX,S=p.clientY,B=O(y.current),U=W.translate(window.innerWidth/2,window.innerHeight/2).scale(3.5).translate(-s.cx,-s.cy);B.transition().duration(800).ease(T).call(u.current.transform,U),setTimeout(()=>{i(s,{x:w,y:S})},200)},A=s=>{s.stopPropagation(),g?.(),l(null),M()};return e.jsxs("div",{className:r.container,children:[e.jsx(F,{children:o&&e.jsxs(P.button,{className:r.backButton,onClick:A,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Multiverse"]})}),e.jsx(F,{mode:"wait",children:(()=>{const s=o?o.backgroundUrl:d;return s&&(s.endsWith(".mp4")||s.endsWith(".webm")||s.endsWith(".mov"))?e.jsx(P.video,{className:r.backgroundVideo,src:s,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,initial:{opacity:0,scale:1.15},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:1.2,ease:"easeInOut"}},o?o.id:"base"):e.jsx(P.div,{className:r.backgroundLayer,initial:{opacity:0,scale:1.15},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:1.2,ease:"easeInOut"},style:{backgroundImage:`url(${s})`}},o?o.id:"base")})()}),e.jsx("div",{className:r.backgroundDimmer}),e.jsxs("svg",{ref:y,className:`${r.svg} ${x?r.pickingMode:""}`,onClick:L,children:[e.jsxs("defs",{children:[x&&e.jsx("pattern",{id:"grid",width:"100",height:"100",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 100 0 L 0 0 0 100",fill:"none",stroke:"rgba(255,255,255,0.05)",strokeWidth:"1"})}),j.map(s=>e.jsxs("radialGradient",{id:`grad-${s.id}`,cx:"50%",cy:"50%",r:"50%",children:[e.jsx("stop",{offset:"0%",stopColor:s.color,stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:s.color,stopOpacity:"0"})]},`grad-${s.id}`))]}),e.jsxs("g",{ref:a,children:[x&&e.jsx("rect",{width:"2000",height:"2000",x:"-500",y:"-500",fill:"url(#grid)",pointerEvents:"none"}),!o&&j.map(s=>e.jsxs("g",{className:r.universeIcon,children:[e.jsxs("g",{transform:`translate(${s.cx}, ${s.cy})`,children:[e.jsxs("g",{className:r.spiralArms,style:{color:s.color},children:[e.jsx("circle",{r:"150",fill:`url(#grad-${s.id})`,pointerEvents:"none"}),e.jsx("path",{className:`${r.spiralArm} ${r.arm1}`,d:"M 0 0 q -20 -60 40 -100 t 80 20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("path",{className:`${r.spiralArm} ${r.arm2}`,d:"M 0 0 q 60 -20 100 40 t -20 80",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("path",{className:`${r.spiralArm} ${r.arm3}`,d:"M 0 0 q 20 60 -40 100 t -80 -20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),e.jsxs("g",{className:r.stars,children:[e.jsx("circle",{className:r.star,cx:"30",cy:"-40",r:"1.5",fill:"white"}),e.jsx("circle",{className:r.star,cx:"-50",cy:"20",r:"1",fill:"white"}),e.jsx("circle",{className:r.star,cx:"60",cy:"50",r:"2",fill:"white"}),e.jsx("circle",{className:r.star,cx:"-20",cy:"-70",r:"1.2",fill:"white"}),e.jsx("circle",{className:r.star,cx:"80",cy:"-10",r:"1.5",fill:"white"}),e.jsx("circle",{className:r.star,cx:"-40",cy:"80",r:"1",fill:"white"})]})]}),e.jsx("circle",{r:"80",fill:s.color,opacity:"0.15",className:r.glowCircle,style:{stroke:s.color,strokeWidth:1.5}})]}),e.jsx("foreignObject",{x:s.cx-70,y:s.cy-70,width:"140",height:"140",onClick:p=>E(s,p),children:e.jsx("div",{className:r.iconWrapper,children:e.jsx("div",{className:r.iconContainer,style:{width:"100px",height:"100px",border:`3px solid ${s.color}`,boxShadow:`0 0 35px ${s.color}99`},children:e.jsx("img",{src:s.thumbUrl,alt:s.name,className:r.iconImage})})})}),e.jsx("text",{x:s.cx,y:s.cy+75,className:r.regionText,children:s.name})]},s.id)),o&&o.locations.map(s=>e.jsxs("g",{className:r.locationMarker,style:{color:o.color},children:[e.jsx("circle",{cx:s.cx,cy:s.cy,r:"60",fill:o.color,opacity:"0.1",className:r.sonarRing}),e.jsx("foreignObject",{x:s.cx-55,y:s.cy-55,width:"110",height:"110",onClick:p=>R(s,p),style:{cursor:"pointer"},children:e.jsx("div",{className:r.iconWrapper,children:e.jsx("div",{className:r.iconContainer,style:{width:"80px",height:"80px",border:`2px solid ${o.color}`,boxShadow:`0 0 25px ${o.color}99`},children:e.jsx("img",{src:s.thumbUrl,alt:s.name,className:r.iconImage})})})}),e.jsx("text",{x:s.cx,y:s.cy+60,className:r.locationText,children:s.name})]},s.id))]})]})]})}const Ue="_adminContainer_w0o9p_1",Se="_toggleBtn_w0o9p_25",Ce="_content_w0o9p_59",Be="_panelHeader_w0o9p_93",Ae="_headerActions_w0o9p_127",Ie="_saveFileBtn_w0o9p_137",Me="_item_w0o9p_161",$e="_active_w0o9p_161",Ee="_globalSection_w0o9p_171",Re="_globalLabel_w0o9p_203",Oe="_editorContent_w0o9p_219",Pe="_editorFooter_w0o9p_229",De="_locItemEditor_w0o9p_241",We="_locRow_w0o9p_263",Te="_deleteLocBtn_w0o9p_293",Fe="_locThumbLabel_w0o9p_319",He="_locPreview_w0o9p_351",Ve="_locRelocateRow_w0o9p_371",qe="_miniRelocateBtn_w0o9p_401",Je="_miniPickMode_w0o9p_423",ze="_addLocActions_w0o9p_463",Ge="_locDescArea_w0o9p_475",Ye="_pickMode_w0o9p_513",Ke="_confirmBtn_w0o9p_579",Xe="_cancelBtn_w0o9p_599",Ze="_saveBtn_w0o9p_633",n={adminContainer:Ue,toggleBtn:Se,content:Ce,panelHeader:Be,headerActions:Ae,saveFileBtn:Ie,item:Me,active:$e,globalSection:Ee,globalLabel:Re,editorContent:Oe,editorFooter:Pe,locItemEditor:De,locRow:We,deleteLocBtn:Te,locThumbLabel:Fe,locPreview:He,locRelocateRow:Ve,miniRelocateBtn:qe,miniPickMode:Je,addLocActions:ze,locDescArea:Ge,pickMode:Ye,confirmBtn:Ke,cancelBtn:Xe,saveBtn:Ze};function Qe({data:l,config:o,onUpdate:j,onConfigUpdate:x,onCoordPick:d,pickedCoords:i,onPickingStateChange:g}){const[_,y]=m.useState(!1),[a,u]=m.useState(null),[M,k]=m.useState(!1),[E,L]=m.useState(!1),[R,A]=m.useState(null),[s,p]=m.useState(""),[w,S]=m.useState(""),B=t=>{const c=l.map(h=>h.id===t.id?t:h);j(c),u(t)},I=async()=>{try{const t=await fetch("/api/save-data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:o,regions:l})}),c=await t.json();t.ok?alert(`âœ… Changes saved to Supabase successfully!

Your lore data is now persistent across all devices.`):t.status===401?alert(`ðŸ”’ Authentication Required

You must be signed in as an admin to save changes.

Please sign in and try again.`):alert(`âŒ Failed to save changes:

${c.error||"Unknown error"}`)}catch(t){console.error("Error saving changes:",t),alert(`âŒ Error saving changes:

Please check your internet connection and ensure Supabase is configured correctly.`)}},U=(t,c)=>{c.stopPropagation(),confirm("Are you sure you want to delete this universe?")&&(j(l.filter(h=>h.id!==t)),a?.id===t&&u(null))},$=()=>{const c={id:`univ-${Date.now()}`,name:"New Universe",description:"A newly discovered realm.",color:"#ffffff",cx:500,cy:400,thumbUrl:"/images/multiversal-bg.png",backgroundUrl:"/images/multiversal-bg.png",imageUrl:"/images/multiversal-bg.png",locations:[]};j([...l,c]),u(c)},N=(t,c)=>{const h=t.target.files?.[0];if(h&&a){const f=URL.createObjectURL(h);u({...a,[c]:f})}},v=(t,c)=>{const h=t.target.files?.[0];if(h&&a){const f=URL.createObjectURL(h),X=a.locations.map(D=>D.id===c?{...D,thumbUrl:f}:D);u({...a,locations:X})}},C=()=>{const t=!E;L(t),g?.(t),t?k(!1):d(null)},z=()=>{if(!a||!i)return;const t={...a,cx:Math.round(i.x),cy:Math.round(i.y)};u(t),B(t),L(!1),g?.(!1),d(null)},G=()=>{if(!a||!i)return;const t={id:`loc-${Date.now()}`,name:s||"New Location",description:w||"Description",cx:Math.round(i.x),cy:Math.round(i.y),type:"station",thumbUrl:a.thumbUrl},c={...a,locations:[...a.locations,t]};u(c),B(c),k(!1),g?.(!1),d(null),p(""),S("")},q=t=>{R===t?(A(null),g?.(!1),d(null)):(A(t),k(!1),L(!1),g?.(!0))},Y=t=>{if(!a||!i)return;const c=a.locations.map(f=>f.id===t?{...f,cx:Math.round(i.x),cy:Math.round(i.y)}:f),h={...a,locations:c};u(h),B(h),A(null),g?.(!1),d(null)},K=t=>{const c=t.target.files?.[0];if(c){const h=URL.createObjectURL(c);x({...o,multiverseBackgroundUrl:h})}};return e.jsxs("div",{className:`${n.adminContainer} ${_?n.open:""}`,children:[e.jsx("button",{className:n.toggleBtn,onClick:()=>y(!_),children:_?"Close Admin":"Admin Portal"}),_&&e.jsxs("div",{className:n.content,children:[e.jsxs("div",{className:n.panelHeader,children:[e.jsx("h2",{children:"Universe Management"}),e.jsxs("div",{className:n.headerActions,children:[e.jsx("button",{className:n.addMainBtn,onClick:$,children:"+ New Universe"}),e.jsx("button",{className:n.saveFileBtn,onClick:I,children:"ðŸ’¾ Commit Changes"})]})]}),e.jsxs("div",{className:n.globalSection,children:[e.jsx("h3",{children:"Global Settings"}),e.jsxs("label",{className:n.globalLabel,children:["Multiverse Background",e.jsxs("div",{className:n.fileInputWrapper,children:[e.jsx("input",{type:"file",accept:"image/*,video/mp4,video/webm,video/quicktime",onChange:K}),e.jsx("div",{className:n.previewSmall,style:{backgroundImage:`url(${o.multiverseBackgroundUrl})`}})]})]})]}),e.jsx("div",{className:n.list,children:l.map(t=>e.jsxs("div",{className:`${n.item} ${a?.id===t.id?n.active:""}`,children:[e.jsx("span",{children:t.name}),e.jsxs("div",{className:n.itemActions,children:[e.jsx("button",{onClick:()=>u(t),children:"Edit"}),e.jsx("button",{className:n.deleteBtn,onClick:c=>U(t.id,c),children:"Delete"})]})]},t.id))}),a&&e.jsxs("div",{className:n.editor,children:[e.jsxs("div",{className:n.editorHeader,children:[e.jsxs("h3",{children:["Editing: ",a.name]}),e.jsx("button",{className:n.closeEditor,onClick:()=>{u(null),L(!1),k(!1),A(null),g?.(!1),d(null)},children:"Ã—"})]}),e.jsxs("div",{className:n.editorContent,children:[e.jsxs("label",{children:["Universe Name",e.jsx("input",{value:a.name,onChange:t=>u({...a,name:t.target.value})})]}),e.jsxs("div",{className:n.relocateSection,children:[e.jsxs("p",{children:["Map Placement: ",a.cx,", ",a.cy]}),E?e.jsxs("div",{className:n.pickMode,children:[e.jsx("p",{children:"Click on map below..."}),e.jsxs("p",{children:["New: ",i?`${Math.round(i.x)}, ${Math.round(i.y)}`:"-"]}),e.jsx("button",{onClick:z,disabled:!i,children:"Apply Position"}),e.jsx("button",{onClick:C,children:"Cancel"})]}):e.jsx("button",{onClick:C,children:"Relocate on Map"})]}),e.jsxs("div",{className:n.imageUploads,children:[e.jsxs("label",{children:["Universe Icon",e.jsxs("div",{className:n.fileInputWrapper,children:[e.jsx("input",{type:"file",accept:"image/*",onChange:t=>N(t,"thumbUrl")}),e.jsx("div",{className:n.previewSmall,style:{backgroundImage:`url(${a.thumbUrl})`}})]})]}),e.jsxs("label",{children:["Background Image",e.jsxs("div",{className:n.fileInputWrapper,children:[e.jsx("input",{type:"file",accept:"image/*,video/mp4,video/webm,video/quicktime",onChange:t=>N(t,"backgroundUrl")}),e.jsx("div",{className:n.previewSmall,style:{backgroundImage:`url(${a.backgroundUrl})`}})]})]})]}),e.jsxs("div",{className:n.locationList,children:[e.jsx("h4",{children:"Local Points"}),a.locations.map(t=>e.jsxs("div",{className:n.locItemEditor,children:[e.jsxs("div",{className:n.locRow,children:[e.jsx("input",{value:t.name,onChange:c=>{const h=a.locations.map(f=>f.id===t.id?{...f,name:c.target.value}:f);u({...a,locations:h})}}),e.jsxs("select",{value:t.type,onChange:c=>{const h=a.locations.map(f=>f.id===t.id?{...f,type:c.target.value}:f);u({...a,locations:h})},children:[e.jsx("option",{value:"planet",children:"Planet"}),e.jsx("option",{value:"station",children:"Station"}),e.jsx("option",{value:"anomaly",children:"Anomaly"})]}),e.jsx("button",{className:n.deleteLocBtn,onClick:()=>{const c=a.locations.filter(h=>h.id!==t.id);u({...a,locations:c})},children:"Ã—"})]}),e.jsx("div",{className:n.locRow,children:e.jsx("textarea",{className:n.locDescArea,value:t.description,placeholder:"Description",onChange:c=>{const h=a.locations.map(f=>f.id===t.id?{...f,description:c.target.value}:f);u({...a,locations:h})}})}),e.jsxs("div",{className:n.locRow,children:[e.jsxs("label",{className:n.locThumbLabel,children:["Thumb",e.jsx("input",{type:"file",accept:"image/*",onChange:c=>v(c,t.id)})]}),e.jsx("div",{className:n.locPreview,style:{backgroundImage:`url(${t.thumbUrl})`}})]}),e.jsxs("div",{className:n.locRelocateRow,children:[e.jsxs("p",{children:["Pos: ",t.cx,", ",t.cy]}),R!==t.id?e.jsx("button",{className:n.miniRelocateBtn,onClick:()=>q(t.id),children:"Relocate"}):e.jsxs("div",{className:n.miniPickMode,children:[e.jsxs("span",{children:["New: ",i?`${Math.round(i.x)}, ${Math.round(i.y)}`:"-"]}),e.jsx("button",{onClick:()=>Y(t.id),disabled:!i,children:"Set"}),e.jsx("button",{onClick:()=>q(t.id),children:"Cancel"})]})]})]},t.id))]}),M?e.jsxs("div",{className:n.addLocForm,children:[e.jsx("p",{children:"Click map to pick coords"}),e.jsxs("p",{children:["Point: ",i?`${Math.round(i.x)}, ${Math.round(i.y)}`:"-"]}),e.jsx("input",{placeholder:"Name",value:s,onChange:t=>p(t.target.value)}),e.jsx("textarea",{placeholder:"Description",value:w,onChange:t=>S(t.target.value)}),e.jsxs("div",{className:n.addLocActions,children:[e.jsx("button",{className:n.confirmBtn,onClick:G,disabled:!i,children:"Confirm Point"}),e.jsx("button",{className:n.cancelBtn,onClick:()=>{k(!1),g?.(!1)},children:"Cancel"})]})]}):e.jsx("button",{className:n.addPointBtn,onClick:()=>{k(!0),L(!1),g?.(!0)},children:"+ Add Point"}),e.jsx("div",{className:n.editorFooter,children:e.jsx("button",{className:n.saveBtn,onClick:()=>B(a),children:"Apply All Local Changes"})})]})]})]})]})}const et="_backdrop_1dns5_1",tt="_overlay_1dns5_17",st="_closeButton_1dns5_59",nt="_content_1dns5_105",at="_imageContainer_1dns5_117",ot="_image_1dns5_117",it="_title_1dns5_169",rt="_description_1dns5_193",ct="_metaSection_1dns5_211",lt="_metaItem_1dns5_227",dt="_metaValue_1dns5_255",b={backdrop:et,overlay:tt,closeButton:st,content:nt,imageContainer:at,image:ot,title:it,description:rt,metaSection:ct,metaItem:lt,metaValue:dt};function mt({location:l,origin:o,regionColor:j,onClose:x}){return o?e.jsx(F,{children:l&&e.jsxs(e.Fragment,{children:[e.jsx(P.div,{className:b.backdrop,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),e.jsxs(P.div,{className:b.overlay,style:{"--origin-x":`${o.x}px`,"--origin-y":`${o.y}px`,"--accent-color":j},initial:{opacity:0,scale:.1,x:o.x-window.innerWidth/2,y:o.y-window.innerHeight/2},animate:{opacity:1,scale:1,x:0,y:0},exit:{opacity:0,scale:.1,x:o.x-window.innerWidth/2,y:o.y-window.innerHeight/2},transition:{type:"spring",stiffness:200,damping:25},children:[e.jsx("button",{onClick:x,className:b.closeButton,children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),e.jsxs("div",{className:b.content,children:[e.jsx("div",{className:b.imageContainer,children:e.jsx("img",{src:l.thumbUrl,alt:l.name,className:b.image})}),e.jsx("h2",{className:b.title,children:l.name}),e.jsx("p",{className:b.description,children:l.description}),e.jsxs("div",{className:b.metaSection,children:[e.jsxs("div",{className:b.metaItem,children:[e.jsx("span",{children:"Point ID"}),e.jsx("span",{className:b.metaValue,children:l.id.toUpperCase()})]}),e.jsxs("div",{className:b.metaItem,children:[e.jsx("span",{children:"Type"}),e.jsx("span",{className:b.metaValue,children:l.type.toUpperCase()})]}),e.jsxs("div",{className:b.metaItem,children:[e.jsx("span",{children:"Coordinates"}),e.jsxs("span",{className:b.metaValue,children:[l.cx,", ",l.cy]})]})]})]})]})]})}):null}const ut={multiverseBackgroundUrl:"/videos/Lore%20Background.mp4"},pt=[{id:"nebula-prime",name:"ALPHA ONE",description:"The central hub of the galaxy, teeming with trade and ancient technology.",color:"#4f46e5",cx:500,cy:300,thumbUrl:"/images/nebula-prime-thumb.png",backgroundUrl:"/images/nebula-prime.png",imageUrl:"/images/nebula-prime.png",locations:[{id:"prime-core",name:"The Core",description:"Central command of the hub.",cx:400,cy:350,type:"station",thumbUrl:"/images/nebula-prime-thumb.png"},{id:"trading-outpost",name:"Outpost 7",description:"Busy trading post.",cx:600,cy:250,type:"station",thumbUrl:"/images/nebula-prime-thumb.png"},{id:"ancient-shard",name:"Ancient Shard",description:"Mysterious artifact floating in space.",cx:500,cy:500,type:"anomaly",thumbUrl:"/images/nebula-prime-thumb.png"}]},{id:"cryo-wastes",name:"Cryo Wastes",description:"A frozen sector where entropy has slowed time itself.",color:"#06b6d4",cx:200,cy:200,thumbUrl:"/images/cryo-wastes.png",backgroundUrl:"/images/cryo-wastes.png",imageUrl:"/images/cryo-wastes.png",locations:[{id:"ice-citadel",name:"Ice Base",description:"A fortress built into a moon.",cx:150,cy:150,type:"planet",thumbUrl:"/images/cryo-wastes.png"},{id:"frozen-wreck",name:"Frozen Wreck",description:"A ship lost to the ice.",cx:250,cy:250,type:"anomaly",thumbUrl:"/images/cryo-wastes.png"}]},{id:"magma-forge",name:"Magma Forge",description:"Industrial core mining heavy elements from dying stars.",color:"#ef4444",cx:800,cy:600,thumbUrl:"/images/magma-forge.png",backgroundUrl:"/images/magma-forge.png",imageUrl:"/images/magma-forge.png",locations:[{id:"smelter-complex",name:"Smelter Complex",description:"Primary refining station.",cx:750,cy:550,type:"station",thumbUrl:"/images/magma-forge.png"},{id:"lava-extraction",name:"Extraction Site B",description:"Mining operation in the magma rivers.",cx:850,cy:650,type:"planet",thumbUrl:"/images/magma-forge.png"}]},{id:"void-expanse",name:"Void Expanse",description:"Mysterious dark matter cloud. Enter at your own risk.",color:"#8b5cf6",cx:850,cy:150,thumbUrl:"/images/void-expanse.png",backgroundUrl:"/images/void-expanse.png",imageUrl:"/images/void-expanse.png",locations:[{id:"dark-anchor",name:"Dark Anchor",description:"Stable point in the void.",cx:800,cy:100,type:"anomaly",thumbUrl:"/images/void-expanse.png"},{id:"void-eye",name:"The Eye",description:"Silent observation post.",cx:900,cy:200,type:"station",thumbUrl:"/images/void-expanse.png"}]},{id:"univ-1767135380112",name:"ALPHA ONE",description:"A newly discovered realm.",color:"#ffffff",cx:500,cy:400,thumbUrl:"/images/multiversal-bg.png",backgroundUrl:"/images/multiversal-bg.png",imageUrl:"/images/multiversal-bg.png",locations:[]},{id:"univ-1767136475924",name:"Test Universe",description:"A newly discovered realm.",color:"#ffffff",cx:500,cy:400,thumbUrl:"/images/multiversal-bg.png",backgroundUrl:"/images/multiversal-bg.png",imageUrl:"/images/multiversal-bg.png",locations:[]}],gt=void 0,ht=void 0;throw new Error("Missing Supabase environment variables. Please check your .env.local file.");const V=se(gt,ht,{auth:{persistSession:!0,autoRefreshToken:!0}});async function xt(){const{data:l,error:o}=await V.from("lore_regions").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(o)throw console.error("Error fetching regions:",o),o;if(!l||l.length===0)return[];const{data:j,error:x}=await V.from("lore_locations").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(x)throw console.error("Error fetching locations:",x),x;return l.map(i=>({...i,locations:j?.filter(g=>g.region_id===i.id)||[]}))}async function ft(){const{data:l,error:o}=await V.from("lore_config").select("*").eq("config_key","multiverse_background").single();return o?(console.error("Error fetching lore config:",o),null):l}function yt(){const[l,o]=m.useState(null),[j,x]=m.useState(null),[d,i]=m.useState(null),[g,_]=m.useState(pt),[y,a]=m.useState(ut),[u,M]=m.useState(null),[k,E]=m.useState(!1),[L,R]=m.useState(!1),[A,s]=m.useState(!0),p=m.useRef(null);m.useEffect(()=>{async function I(){try{const[U,$]=await Promise.all([xt(),ft()]);if(U&&U.length>0){const N=U.map(v=>({id:v.region_id,name:v.name,description:v.description,color:v.color,cx:v.cx,cy:v.cy,thumbUrl:v.thumb_url,backgroundUrl:v.background_url,imageUrl:v.image_url,locations:(v.locations||[]).map(C=>({id:C.location_id,name:C.name,description:C.description,cx:C.cx,cy:C.cy,type:C.location_type,thumbUrl:C.thumb_url}))}));_(N),console.log("âœ… Loaded data from Supabase")}else{const N=localStorage.getItem("universeData");N?(_(JSON.parse(N)),console.log("ðŸ“¦ Loaded data from localStorage")):console.log("ðŸ“‹ Using default fallback data")}if($)a($.config_value),console.log("âœ… Loaded config from Supabase");else{const N=localStorage.getItem("universeConfig");N&&(a(JSON.parse(N)),console.log("ðŸ“¦ Loaded config from localStorage"))}}catch(U){console.error("Error loading data from Supabase:",U);const $=localStorage.getItem("universeData"),N=localStorage.getItem("universeConfig");if($)try{_(JSON.parse($)),console.log("ðŸ“¦ Fallback: Loaded data from localStorage")}catch(v){console.error("Failed to parse saved universe data:",v)}if(N)try{a(JSON.parse(N)),console.log("ðŸ“¦ Fallback: Loaded config from localStorage")}catch(v){console.error("Failed to parse saved config:",v)}}finally{s(!1),R(!0)}}I()},[]),m.useEffect(()=>{L&&localStorage.setItem("universeData",JSON.stringify(g))},[g,L]),m.useEffect(()=>{L&&localStorage.setItem("universeConfig",JSON.stringify(y))},[y,L]);const w=l&&g.find(I=>I.id===l.id)||null,S=(I,U)=>{x(I),i(U)},B=()=>{x(null),i(null),p.current?.()};return A?e.jsx("main",{className:"flex items-center justify-center min-h-screen bg-black",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500 mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"Loading Universe Map..."})]})}):e.jsxs("main",{children:[e.jsx(Le,{onRegionSelect:o,selectedRegion:w,universeData:g,onCoordPick:k?M:void 0,baseBackground:y.multiverseBackgroundUrl,onLocationSelect:S,onLocationClose:B,zoomResetRef:p}),e.jsx(mt,{location:j,origin:d,regionColor:w?.color||"#6366f1",onClose:B}),e.jsx(Qe,{data:g,config:y,onUpdate:_,onConfigUpdate:a,onCoordPick:M,pickedCoords:u,onPickingStateChange:E})]})}H.createRoot(document.getElementById("root")).render(e.jsx(Q.StrictMode,{children:e.jsx(yt,{})}));
//# sourceMappingURL=index-CsuqnQmR.js.map
