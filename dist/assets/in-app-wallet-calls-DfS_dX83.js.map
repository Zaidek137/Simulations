{"version":3,"file":"in-app-wallet-calls-DfS_dX83.js","sources":["../../node_modules/thirdweb/dist/esm/transaction/actions/send-and-confirm-transaction.js","../../node_modules/thirdweb/dist/esm/wallets/in-app/core/eip5792/in-app-wallet-calls.js"],"sourcesContent":["import { sendTransaction, } from \"./send-transaction.js\";\nimport { waitForReceipt } from \"./wait-for-tx-receipt.js\";\n/**\n * Sends a transaction using the provided wallet.\n * @param options - The options for sending the transaction.\n * @returns A promise that resolves to the confirmed transaction receipt.\n * @throws An error if the wallet is not connected.\n * @transaction\n * @example\n *\n * ### Basic usage\n * ```ts\n * import { sendAndConfirmTransaction } from \"thirdweb\";\n *\n * const transactionReceipt = await sendAndConfirmTransaction({\n *  account,\n *  transaction\n * });\n * ```\n *\n * ### Gasless usage with [thirdweb Engine](https://portal.thirdweb.com/engine)\n * ```ts\n * const transactionReceipt = await sendAndConfirmTransaction({\n *  account,\n *  transaction,\n *  gasless: {\n *    provider: \"engine\",\n *    relayerUrl: \"https://thirdweb.engine-***.thirdweb.com/relayer/***\",\n *    relayerForwarderAddress: \"0x...\",\n *  }\n * });\n * ```\n *\n * ### Gasless usage with OpenZeppelin\n * ```ts\n * const transactionReceipt = await sendAndConfirmTransaction({\n *  account,\n *  transaction,\n *  gasless: {\n *    provider: \"openzeppelin\",\n *    relayerUrl: \"https://...\",\n *    relayerForwarderAddress: \"0x...\",\n *  }\n * });\n * ```\n */\nexport async function sendAndConfirmTransaction(options) {\n    const submittedTx = await sendTransaction(options);\n    return waitForReceipt(submittedTx);\n}\n//# sourceMappingURL=send-and-confirm-transaction.js.map","import { eth_getTransactionReceipt } from \"../../../../rpc/actions/eth_getTransactionReceipt.js\";\nimport { getRpcClient } from \"../../../../rpc/rpc.js\";\nimport { sendAndConfirmTransaction } from \"../../../../transaction/actions/send-and-confirm-transaction.js\";\nimport { sendBatchTransaction } from \"../../../../transaction/actions/send-batch-transaction.js\";\nimport { LruMap } from \"../../../../utils/caching/lru.js\";\nimport { randomBytesHex } from \"../../../../utils/random.js\";\nconst bundlesToTransactions = new LruMap(1000);\n/**\n * @internal\n */\nexport async function inAppWalletSendCalls(args) {\n    const { account, calls } = args;\n    const transactions = calls.map((call) => ({\n        ...call,\n        chain: args.chain,\n    }));\n    const hashes = [];\n    const id = randomBytesHex(65);\n    bundlesToTransactions.set(id, hashes);\n    if (account.sendBatchTransaction) {\n        const receipt = await sendBatchTransaction({\n            account,\n            transactions,\n        });\n        hashes.push(receipt.transactionHash);\n        bundlesToTransactions.set(id, hashes);\n    }\n    else {\n        for (const tx of transactions) {\n            const receipt = await sendAndConfirmTransaction({\n                account,\n                transaction: tx,\n            });\n            hashes.push(receipt.transactionHash);\n            bundlesToTransactions.set(id, hashes);\n        }\n    }\n    return id;\n}\n/**\n * @internal\n */\nexport async function inAppWalletGetCallsStatus(args) {\n    const { chain, client, id } = args;\n    const bundle = bundlesToTransactions.get(id);\n    if (!bundle) {\n        throw new Error(\"Failed to get calls status, unknown bundle id\");\n    }\n    const request = getRpcClient({ chain, client });\n    let status = \"success\";\n    const receipts = await Promise.all(bundle.map((hash) => eth_getTransactionReceipt(request, { hash })\n        .then((receipt) => ({\n        blockHash: receipt.blockHash,\n        blockNumber: receipt.blockNumber,\n        gasUsed: receipt.gasUsed,\n        logs: receipt.logs.map((l) => ({\n            address: l.address,\n            data: l.data,\n            topics: l.topics,\n        })),\n        status: receipt.status,\n        transactionHash: receipt.transactionHash,\n    }))\n        .catch(() => {\n        status = \"pending\";\n        return null; // Return null if there's an error to filter out later\n    })));\n    return {\n        atomic: false,\n        chainId: chain.id,\n        id,\n        receipts: receipts.filter((r) => r !== null),\n        status,\n        statusCode: 200,\n        version: \"2.0.0\",\n    };\n}\n//# sourceMappingURL=in-app-wallet-calls.js.map"],"names":["sendAndConfirmTransaction","options","submittedTx","sendTransaction","waitForReceipt","bundlesToTransactions","LruMap","inAppWalletSendCalls","args","account","calls","transactions","call","hashes","id","randomBytesHex","receipt","sendBatchTransaction","tx","inAppWalletGetCallsStatus","chain","client","bundle","request","getRpcClient","status","receipts","hash","eth_getTransactionReceipt","l","r"],"mappings":"ySA8CO,eAAeA,EAA0BC,EAAS,CACrD,MAAMC,EAAc,MAAMC,EAAgBF,CAAO,EACjD,OAAOG,EAAeF,CAAW,CACrC,CC3CA,MAAMG,EAAwB,IAAIC,EAAO,GAAI,EAItC,eAAeC,EAAqBC,EAAM,CAC7C,KAAM,CAAE,QAAAC,EAAS,MAAAC,CAAK,EAAKF,EACrBG,EAAeD,EAAM,IAAKE,IAAU,CACtC,GAAGA,EACH,MAAOJ,EAAK,KACpB,EAAM,EACIK,EAAS,CAAA,EACTC,EAAKC,EAAe,EAAE,EAE5B,GADAV,EAAsB,IAAIS,EAAID,CAAM,EAChCJ,EAAQ,qBAAsB,CAC9B,MAAMO,EAAU,MAAMC,EAAqB,CACvC,QAAAR,EACA,aAAAE,CACZ,CAAS,EACDE,EAAO,KAAKG,EAAQ,eAAe,EACnCX,EAAsB,IAAIS,EAAID,CAAM,CACxC,KAEI,WAAWK,KAAMP,EAAc,CAC3B,MAAMK,EAAU,MAAMhB,EAA0B,CAC5C,QAAAS,EACA,YAAaS,CAC7B,CAAa,EACDL,EAAO,KAAKG,EAAQ,eAAe,EACnCX,EAAsB,IAAIS,EAAID,CAAM,CACxC,CAEJ,OAAOC,CACX,CAIO,eAAeK,EAA0BX,EAAM,CAClD,KAAM,CAAE,MAAAY,EAAO,OAAAC,EAAQ,GAAAP,CAAE,EAAKN,EACxBc,EAASjB,EAAsB,IAAIS,CAAE,EAC3C,GAAI,CAACQ,EACD,MAAM,IAAI,MAAM,+CAA+C,EAEnE,MAAMC,EAAUC,EAAa,CAAE,MAAAJ,EAAO,OAAAC,CAAM,CAAE,EAC9C,IAAII,EAAS,UACb,MAAMC,EAAW,MAAM,QAAQ,IAAIJ,EAAO,IAAKK,GAASC,EAA0BL,EAAS,CAAE,KAAAI,CAAI,CAAE,EAC9F,KAAMX,IAAa,CACpB,UAAWA,EAAQ,UACnB,YAAaA,EAAQ,YACrB,QAASA,EAAQ,QACjB,KAAMA,EAAQ,KAAK,IAAKa,IAAO,CAC3B,QAASA,EAAE,QACX,KAAMA,EAAE,KACR,OAAQA,EAAE,MACtB,EAAU,EACF,OAAQb,EAAQ,OAChB,gBAAiBA,EAAQ,eACjC,EAAM,EACG,MAAM,KACPS,EAAS,UACF,KACV,CAAC,CAAC,EACH,MAAO,CACH,OAAQ,GACR,QAASL,EAAM,GACf,GAAAN,EACA,SAAUY,EAAS,OAAQI,GAAMA,IAAM,IAAI,EAC3C,OAAAL,EACA,WAAY,IACZ,QAAS,OACjB,CACA","x_google_ignoreList":[0,1]}